<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Find the Mouse of Ganesha ‚Äî Updated Assets</title>
  <style>
    body {
      font-family: Arial, system-ui;
      background: #f6f6f8;
      margin: 0;
      padding: 16px;
      color: #222
    }

    .wrap {
      max-width: 900px;
      margin: 0 auto;
      text-align: center
    }

    .gameCard {
      background: #fff;
      padding: 12px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(2, 6, 23, 0.08)
    }

    .imgWrap {
      position: relative;
      display: inline-block;
      border-radius: 10px;
      overflow: hidden
    }

    #idol {
      display: block;
      max-width: 100%;
      height: auto
    }

    #mouse {
      position: absolute;
      width: 56px;
      height: 56px;
      transform: translate(-50%, -50%);
      pointer-events: none;
      opacity: 1;
      transition: opacity .2s
    }

    #frameOverlay {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      pointer-events: none
    }

    #confetti {
      position: absolute;
      left: 50%;
      top: 10%;
      transform: translateX(-50%);
      display: none;
      pointer-events: none
    }

    .hud {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px
    }

    .btn {
      background: #ffd54a;
      border: none;
      padding: 8px 12px;
      border-radius: 8px;
      font-weight: 700
    }

    .popup {
      background: #fff;
      padding: 18px;
      border-radius: 10px;
      max-width: 360px;
      margin: 0 auto
    }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center
    }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Find the Mouse of Ganesha üê≠</h1>
    <div class="gameCard">
      <div class="imgWrap" id="imgWrap">
        <img id="idol" src="assets/idol.jpg" alt="idol">
        <img id="mouse" src="assets/mouse.png" alt="mouse">
        <img id="frameOverlay" src="frame.png" alt="frame">
        <img id="confetti" src="confetti.gif" alt="confetti">
      </div>
      <div class="hud">
        <div>Time: <span id="timer">30</span>s</div>
        <div>Attempts: <span id="attempts">0</span></div>
        <div><button class="btn" id="newBtn">New Round</button></div>
      </div>
      <p id="msg">Tap the image to search ‚Äî find the mouse near the idol‚Äôs feet!</p>
    </div>
  </div>

  <div class="overlay" id="overlay">
    <div class="popup" id="popupContent"></div>
  </div>

  <script>
    const idol = document.getElementById('idol');
    const imgWrap = document.getElementById('imgWrap');
    const mouseEl = document.getElementById('mouse');
    const confetti = document.getElementById('confetti');
    const timerEl = document.getElementById('timer');
    const attemptsEl = document.getElementById('attempts');
    const msgEl = document.getElementById('msg');
    const overlay = document.getElementById('overlay');
    const popupContent = document.getElementById('popupContent');

    let HOTSPOTS = [{ x: 0.28, y: 0.78 }, { x: 0.37, y: 0.85 }, { x: 0.55, y: 0.80 }, { x: 0.68, y: 0.83 }];
    let mouseRel = { x: 0.5, y: 0.8 };
    let TIME_LIMIT = 30, timer = TIME_LIMIT, timerId = null, attempts = 0, found = false;
    const SUCCESS_RADIUS_PX = 44;

    function placeMouse() {
      const spot = HOTSPOTS[Math.floor(Math.random() * HOTSPOTS.length)];
      mouseRel = { x: spot.x, y: spot.y };
      positionMouse();
    }

    function positionMouse() {
      const rect = idol.getBoundingClientRect();
      mouseEl.style.left = (mouseRel.x * 100) + '%';
      mouseEl.style.top = (mouseRel.y * 100) + '%';
      mouseEl.style.opacity = 0.5;
    }

    function startTimer() {
      stopTimer();
      timer = TIME_LIMIT; timerEl.textContent = timer;
      timerId = setInterval(function () { timer--; timerEl.textContent = timer; if (timer <= 0) { stopTimer(); gameOver(false); } }, 1000);
    }
    function stopTimer() { if (timerId) { clearInterval(timerId); timerId = null; } }

    function resetRound() {
      found = false; attempts = 0; attemptsEl.textContent = attempts; msgEl.textContent = 'Tap the image to search ‚Äî find the mouse near the idol‚Äôs feet!'; placeMouse(); startTimer(); mouseEl.style.opacity = 0.3; confetti.style.display = 'none';
    }

    imgWrap.addEventListener('click', function (ev) { if (found) return; var rect = idol.getBoundingClientRect(); if (ev.clientX < rect.left || ev.clientX > rect.right || ev.clientY < rect.top || ev.clientY > rect.bottom) return; attempts++; attemptsEl.textContent = attempts; var clickRelX = (ev.clientX - rect.left) / rect.width; var clickRelY = (ev.clientY - rect.top) / rect.height; var dx = (clickRelX - mouseRel.x) * rect.width; var dy = (clickRelY - mouseRel.y) * rect.height; var dist = Math.sqrt(dx * dx + dy * dy); if (dist <= SUCCESS_RADIUS_PX) { found = true; stopTimer(); mouseEl.style.opacity = 1; confetti.style.display = 'block'; setTimeout(function () { confetti.style.display = 'none'; }, 2500); showPopup(true); try { if (window.onSuccess) window.onSuccess({ game: 'find-mouse', timeLeft: timer, attempts: attempts }); } catch (e) { } } else { flash('Try a little to the ' + (dx > 0 ? 'left' : 'right')); } });

    function showPopup(success) { overlay.style.display = 'flex'; popupContent.innerHTML = success ? '<div style="font-size:20px;font-weight:800">Blessings! üéâ</div><div style="margin-top:8px">You found the mouse ‚Äî show this to the robot tablet.</div>' : '<div style="font-size:20px;font-weight:800">Time\'s up</div><div style="margin-top:8px">Try again for a blessing!</div>'; }
    document.getElementById('newBtn').addEventListener('click', function () { overlay.style.display = 'none'; resetRound(); });
    window.addEventListener('resize', positionMouse);
    window.addEventListener('load', function () { if (idol.complete) { placeMouse(); startTimer(); } else idol.onload = function () { placeMouse(); startTimer(); }; });

    function flash(msg) { var old = document.getElementById('toast'); if (old) old.remove(); var el = document.createElement('div'); el.id = 'toast'; el.style.position = 'fixed'; el.style.left = '50%'; el.style.bottom = '20px'; el.style.transform = 'translateX(-50%)'; el.style.background = '#071126'; el.style.color = '#fff'; el.style.padding = '8px 12px'; el.style.borderRadius = '8px'; el.style.zIndex = 999; el.textContent = msg; document.body.appendChild(el); setTimeout(function () { el.remove(); }, 1400); }

  </script>
</body>

</html>